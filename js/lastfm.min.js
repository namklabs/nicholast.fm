(function(){var d={format:"json"},n={url:"http://ws.audioscrobbler.com/2.0/",dataType:"jsonp",timeout:5E3},b={},g={},e;window.LastFM=function(a,h,p){if("string"==typeof a){var l=function(a,j,b){var c={},f=$.Deferred();if("timeout"==j&&(++e,5>e))return $.extend(c,this),"timeout"==j&&(c.timeout+=1E3*e),$.ajax(c).then(null,l).then(f.resolve,f.reject),f;f.reject(a,j,b);return f},k,c=$.Deferred(),m=c.promise();e=0;h.method=a;$.extend(h,d);b.data=h;b.cache=p;$.ajax(b).then(null,l).then(function(a,b,d){e=0;a.error?c.reject(d,b,a):c.resolve(a,b,d)},c.reject);for(k in g)m[k](g[k]);return m}$.extend(b,n,a);d.api_key=a.api_key||d.api_key;$.extend(g,a.callbacks)}})();