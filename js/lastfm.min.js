(function(){function h(a){return function(d,c,e){var b=$.Deferred();if(--a)return"timeout"==c&&(this.timeout+=1E3),$.ajax(this).then(null,h(a)).then(b.resolve,b.reject),b;b.reject(d,c,e);return b}}var f={format:"json"},l={url:"http://ws.audioscrobbler.com/2.0/",dataType:"jsonp",timeout:9E3},c={},g={};window.LastFM=function(a,d,k){if("string"==typeof a){var e,b=$.Deferred(),j=b.promise();d.method=a;$.extend(d,f);c.data=d;c.cache=k;$.ajax(c).then(null,h(5)).then(function(a,c,d){a.error?b.reject(d,c,a):b.resolve(a,c,d)},b.reject);for(e in g)j[e](g[e]);return j}$.extend(c,l,a);f.api_key=a.api_key||f.api_key;$.extend(g,a.callbacks)}})();